<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script src="../classes.js" defer></script>
    <script src="../converter.js" defer></script>
</head>
<body>


</body>
</html>

<script type="module">
    const horsens = {
        name: "Horsens",
        latitude: 55.860916,
        longitude: 9.850000
    };


    var xhr = new XMLHttpRequest();
    var url = "https://api.open-meteo.com/v1/forecast" +
        "?latitude=" + horsens.latitude +
        "&longitude=" + horsens.longitude +
        "&hourly=temperature_2m" +
        "&current_weather=true" +
        "&timezone=Europe%2FBerlin" +
        "&start_date=2023-09-07" +
        "&end_date=2023-09-08";

    xhr.open("GET", url, true);

    xhr.onreadystatechange = function () {
        if (xhr.readyState === 4 && xhr.status === 200) {
            var response = JSON.parse(xhr.responseText);
            console.log(response);
            createTempritureTable(TemperatureConverter(response,horsens.name));
        } else if (xhr.readyState === 4) {
            console.error("Request failed with status:", xhr.status);
        }
    };

    xhr.send()


    function createTempritureTable(data) {
        let table = document.createElement("table");
        let tr = document.createElement("tr");
        let th = document.createElement("th");
        let th2 = document.createElement("th");
        th.innerText = "Time";
        th2.innerText = "Temperature";
        tr.appendChild(th);
        tr.appendChild(th2);
        table.appendChild(tr);

        for (let i = 0; i < data.length; i++){
            let tr = document.createElement("tr");
            let td = document.createElement("td");
            let td2 = document.createElement("td");
            td.innerText = data[i].getTime();
            td2.innerText = data[i].getMax() + " " + data[i].getUnit();
            tr.appendChild(td);
            tr.appendChild(td2);
            table.appendChild(tr);
        }
        document.body.appendChild(table);
    }

</script>